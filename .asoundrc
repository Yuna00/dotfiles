defaults.pcm.card 1
defaults.ctl.card 1

# Your existing dmixer for playback (headset)
pcm.dmixer {
    type dmix
    ipc_key 1024
    slave {
        pcm "hw:1,0"    # headset
        rate 48000
        channels 2
        format S16_LE
        period_time 0
        period_size 1024
    }
}

# Add capture for microphone
pcm.dsnooper {
    type dsnoop
    ipc_key 2048
    slave {
        pcm "hw:0,0"    # microphone
        channels 1
        rate 48000
        format S16_LE
    }
}

# Combine them
pcm.duplex {
    type asym
    playback.pcm "dmixer"
    capture.pcm "dsnooper"
}

pcm.!default {
    type plug
    slave.pcm "duplex"
}

ctl.!default {
    type hw
    card 1
}
